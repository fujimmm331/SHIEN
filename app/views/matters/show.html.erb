<div class="matter_contents">
  <%= render 'share/menu_bar.html.erb'%>
  <div class="matter_area">
    <div class="left_area">
      <%# 案件詳細を表示 %>
      <div class="matter_info">
        <h2 class="new_matter"><span class="title"><%= @matter.name%></span></h2>

        <div class="field">
          <div class="matter_title">先方のご担当者：</div>
          <span class="matter_text"><%= @matter.sales_person%> / <%= @matter.kana_sales_person%> 様</span>
        </div>

        <div class="field">
          <div class="matter_title">電話番号：</div>
          <span class="matter_text"><%= @matter.phone_number%></span>
          <div class="matter_title">携帯電話：</div>
          <span class="matter_text"><%= @matter.cell_phone_number%></span>
        </div>

        <div class="field">
          <div class="matter_title">住所：</div>
          <span class="matter_text"><%= @matter.postal_code%></span>
          <div><span class="matter_text"><%= @matter.municipality%><%= @matter.address%><%= @matter.building%></span></div>
        </div>

        <div class="field">
          <div>担当者：</div>
          <%= @matter.user.team.name%><br>
          <%= @matter.user.name%>
        </div>

        <div class="matter_btn_area">
          <%= link_to "コンタクトログ一覧", matter_contact_logs_path(@matter.id) , class:["matter_edit_btn","matter_contactlog_btn"] %>
          <% if @matter.user.id == current_user.id%><%= link_to "編集する", edit_matter_path(@matter.id), class:"matter_edit_btn" %><%end%>
          <% if @matter.user.id == current_user.id%><%= link_to "削除する", matter_path(@matter.id), class:["matter_edit_btn","matter_destroy_btn"], method: :delete, data:{ confirm: '本当に削除して良いですか?', cancel: 'やめる', commit: '削除する'}, title: '削除確認' %><%end%>
        </div>
      </div>
      <%# /案件詳細を表示 %>
    </div>

    
    <div class="right_area">
         <%# コンタクトログ入力フォームを表示 %>
      <div class="contact_log_area">
        <h5><span class="title">コンタクトログを残す</span></h5>
        <%= form_with model:[@matter, @contact_log], local: true do |f|%>
        <div class="contact_log_box_side">
          <%= f.label :status, "対応あり", class:"contact_action_required_box"%>
          <%= f.check_box :status, {class:"contact_action_required_box"}, "要対応", nil%>
        </div>
        <div class="contact_log_column">※チェックを入れると、担当者に通知が届きます。</div>
            
        <div class="contact_log_form_side">
          <%= f.text_area :comment, size: "55x3", class:"contact_log_form", placeholder: "テキストを入力"%>
          <%= f.submit "保存する", class:"contact_log_btn"%>
        </div>
        <% end %>
      </div>
      <%# /コンタクトログ入力フォームを表示 %>

      <%# 直近のコンタクトログを表示 %>
      <div class="contact_logs_area">
    
        <h5><span class="title">直近のコンタクトログ</span></h5>


        <div class="logs">
        <% if @logs != [] %>
        <% @logs.each do |log|%>
          
          <div class="contact_log">
            <div class="contact_log_top">
              <% if log.status != nil %><span class="contact_log_status"><%= log.status%></span><%end%>
            </div>
            <div class="contact_log_middle"><%= log.comment%></div>
            <div class="contact_log_bottom">
              <div>記入者：<%= log.user.name%></div>
              <div><%=l log.created_at%></div>
            </div>
          </div>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-double-down" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M1.646 6.646a.5.5 0 0 1 .708 0L8 12.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
            <path fill-rule="evenodd" d="M1.646 2.646a.5.5 0 0 1 .708 0L8 8.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
          </svg>
        <% end %>
        <%= link_to "過去のコンタクトログを見る", matter_contact_logs_path(@matter.id) , class:["matter_edit_btn","matter_contactlog_btn2"] %>

        <% else %>
          <div>コンタクトログはありません。</div>
        <% end %>
        </div>
      </div>
    </div>
    <%# /直近のコンタクトログを表示 %>
  </div>
</div>